supstore_df_new[Profit_pct <= 0 & Profit_pct > -10, Profit_pct_range := "0 to -10%"]
supstore_df_new[Profit_pct <= -10 & Profit_pct > -20, Profit_pct_range := "-10% to -20%"]
supstore_df_new[Profit_pct <= -20 & Profit_pct > -30, Profit_pct_range := "-20% to -30%"]
supstore_df_new[Profit_pct <= -30 & Profit_pct > -40, Profit_pct_range := "-30% to -40%"]
supstore_df_new[Profit_pct <= -40 & Profit_pct > -50, Profit_pct_range := "-40% to -50%"]
supstore_df_new[Profit_pct <= -50 & Profit_pct > -100, Profit_pct_range := "-50% to -100"]
supstore_df_new[Profit_pct <= -100 & Profit_pct > -150, Profit_pct_range := "-100% to -150%"]
supstore_df_new[Profit_pct <= -150 & Profit_pct > -300, Profit_pct_range := "-150% to -300%"]
#Numeric conversion
supstore_df_new$Profit_pct_range = as.factor(supstore_df_new$Profit_pct_range)
supstore_df_new$Profit_pct = as.numeric(supstore_df_new$Profit_pct)
#List for customer segments
customer_seg_list = as.list(unique(supstore_df_new$Segment))
#List for Region segments
region_seg_list = as.list(unique(supstore_df_new$Region))
#List for category segments
category_seg_list = as.list(unique(supstore_df_new$Category))
if(sessionInfo()['basePkgs']=="dplyr" | sessionInfo()['otherPkgs']=="dplyr"){
detach(package:dplyr, unload=TRUE)
}
library(plyr)
#install.packages("arules", dependencies=TRUE)
library(arules)
df_itemList_bskt3 = ddply(supstore_df_new,
c("Order.ID", "Category", "Order.Date"),
function(supstore_df_new) paste(supstore_df_new$Product.Name, collapse = "|"))
dim(df_itemList_bskt3)
#For Basket Analysis, we do not need Order.ID and Order.Date
df_itemList_bskt3$Order.ID = NULL
df_itemList_bskt3$Order.Date = NULL
df_itemList_bskt3$Category = NULL
#Rename column headers for ease of use
colnames(df_itemList_bskt3) = c("itemList")
#Write dataframe to a csv file using write.csv()
write.csv(df_itemList_bskt3,"ItemList.csv", quote=FALSE, row.names = TRUE)
#Using the read.transactions() functions, we can read the file ItemList.csv and convert it to a transaction format
txn = read.transactions(file = "ItemList.csv", rm.duplicates = TRUE, format = "basket", sep = "|", cols = 1)
#View(txn@itemInfo$labels)
#Removing the Quotes which are introduced in read.transactions
txn@itemInfo$labels = gsub("\"", "", txn@itemInfo$labels)
#View(txn)
head(txn@itemInfo$labels, 40)
#Execute the apriori algorithm on the transactions by specifying minimum values for support and confidence. Support is an indication of how frequently the items appear in the data. Confidence indicates the number of times the if-then statements are found true. A third metric, called lift, can be used to compare confidence with expected confidence
basket_rules = apriori(txn, parameter = list(sup = 0.00025, conf = 0.3, target="rules"))
dim(basket_rules@lhs@itemInfo)
#Print the association rules using function inspect(). Note that if package ‘tm’ attached in the session, it creates a conflict with the arules package. Thus, we need to check and detach the package.
if(sessionInfo()['basePkgs']=="tm" | sessionInfo()['otherPkgs']=="tm"){
detach(package:tm, unload=TRUE)
}
inspect(basket_rules)
#Alternative to inspect() is to convert rules to a dataframe and then use View()
df_basket <- as(basket_rules, "data.frame")
dim(df_basket)
#View(df_basket)
#convert to datframe and view; optional
df_basket <- as(basket_rules,"data.frame")
df_basket$confidence <- df_basket$confidence * 100
# split lhs and rhs into two columns
library(reshape2)
df_basket <- transform(df_basket, rules = colsplit(rules, pattern = "=>", names = c("lhs","rhs")))
# Remove curly brackets around rules
df_basket$rules$lhs <- gsub("[[:punct:]]", "", df_basket$rules$lhs)
df_basket$rules$rhs <- gsub("[[:punct:]]", "", df_basket$rules$rhs)
# convert to chracter
df_basket$rules$lhs <- as.character(df_basket$rules$lhs)
df_basket$rules$rhs <- as.character(df_basket$rules$rhs)
#inspect(df_basket)
library(stringi)
library(dplyr)
#Remove duplicates from LHS
df_basket_filtered =
df_basket %>%
distinct(df_basket$rules$lhs, .keep_all = TRUE)
#Remove column
df_basket_filtered = select(df_basket_filtered, -'df_basket$rules$lhs')
#Input the product name in LHS to show RHS
df_basket_filtered$rules %>%
filter(stri_detect_fixed(lhs, "Acco Hanging Data Binders")) %>%
select(rhs)
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp()
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
2
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp()
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
#Total sales revenue
sales.revenue =
supstore_df_new %>%
summarise(total_revenue = round(sum(Sales)))
sales.revenue
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
#Total sales revenue
sales.revenue =
supstore_df_new %>%
summarise(total_customers = count(Customer.ID))
#Total customers
net.customers =
supstore_df_new %>%
summarise(total_customers = count(Customer.ID))
net.customers
sales.revenue
#Total sales revenue
sales.revenue =
supstore_df_new %>%
summarise(total_revenue = round(sum(Sales)))
sales.revenue
sales.revenue$total_revenue
length(unique(supstore_df_new$Customer.ID))
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
#Average Basket Price
avg.basket.price =
supstore_df_new %>%
group_by(Customer.ID) %>%
summarise(total_revenue = round(sum(Sales)))
View(avg.basket.price)
#Total sales revenue
sales.revenue =
supstore_df_new %>%
summarise(total_revenue = round(sum(Sales)))
#Average Basket Price
avg.basket.price =
supstore_df_new %>%
group_by(Customer.ID) %>%
mutate(avg.price = round( mean(Sales), 1))
View(avg.basket.price)
#Average Basket Price
avg.basket.price =
supstore_df_new %>%
group_by(Customer.ID) %>%
summarise(avg.price = round(mean(Sales), 1))
View(avg.basket.price)
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(Product.Name) %>%
summarise(Orders = n_distinct(Order.ID)) %>%
arrange(desc(Orders)) %>%
head(5)
View(top5_articles)
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(Product.Name) %>%
summarise(Orders = n_distinct(Order.ID)) %>%
mutate(Avg.sales.pct = round( (Average.sales/sum(Average.sales) * 100), 1),
Orders.pct = round( (Orders/sum(Orders) * 100), 1)) %>%
arrange(desc(Orders)) %>%
head(5)
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(Product.Name) %>%
summarise(Orders = n_distinct(Order.ID)) %>%
mutate(Orders.pct = round( (Orders/sum(Orders) * 100), 1)) %>%
arrange(desc(Orders)) %>%
head(5)
View(top5_articles)
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(Product.Name) %>%
summarise(Orders = n_distinct(Order.ID),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))) %>%
mutate(Avg.sales.pct = round( (Average.sales/sum(Average.sales) * 100), 1),
Orders.pct = round( (Orders/sum(Orders) * 100), 1)) %>%
arrange((Orders.pct))
View(top5_articles)
View(top5_articles)
#Overall orders grouped by week days
supstore_df_orders_byMonths =
supstore_df_new %>%
group_by(Ordered.Month) %>%
summarise(Orders = n_distinct(Order.ID),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))) %>%
mutate(Avg.sales.pct = round( (Average.sales/sum(Average.sales) * 100), 1),
Orders.pct = round( (Orders/sum(Orders) * 100), 1)) %>%
arrange((Ordered.Month))
supstore_df_new =
supstore_df %>%
mutate(Profit_pct = round( (Profit/Sales)*100 ,2),
Ordered.Year = lubridate::year(Order.Date),
Ordered.Quarter = lubridate::quarter(Order.Date),
Ordered.Month = lubridate::month(Order.Date, label=TRUE, abbr=TRUE),
Ordered.Day = lubridate::day(Order.Date),
Ordered.Week.day = lubridate::wday(Order.Date, week_start = 1, label=TRUE, abbr=TRUE),
Delivery_time = difftime(Ship.Date, Order.Date, units = c("days"))
)
#Overall orders grouped by week days
supstore_df_orders_byMonths =
supstore_df_new %>%
group_by(Ordered.Month) %>%
summarise(Orders = n_distinct(Order.ID),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))) %>%
mutate(Avg.sales.pct = round( (Average.sales/sum(Average.sales) * 100), 1),
Orders.pct = round( (Orders/sum(Orders) * 100), 1)) %>%
arrange((Ordered.Month))
supstore_df_new =
supstore_df %>%
mutate(Profit_pct = round( (Profit/Sales)*100 ,2),
Ordered.Year = lubridate::year(Order.Date),
Ordered.Quarter = lubridate::quarter(Order.Date),
Ordered.Month = lubridate::month(Order.Date, label=TRUE, abbr=TRUE),
Ordered.Day = lubridate::day(Order.Date),
Ordered.Week.day = lubridate::wday(Order.Date, week_start = 1, label=TRUE, abbr=TRUE),
Delivery_time = difftime(Ship.Date, Order.Date, units = c("days"))
)
View(supstore_df_new)
#Overall orders grouped by week days
supstore_df_orders_byMonths =
supstore_df_new %>%
group_by(Ordered.Month) %>%
summarise(Orders = n_distinct(Order.ID),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))) %>%
mutate(Avg.sales.pct = round( (Average.sales/sum(Average.sales) * 100), 1),
Orders.pct = round( (Orders/sum(Orders) * 100), 1)) %>%
arrange((Ordered.Month))
#Overall orders grouped by week days
supstore_df_orders_byMonths =
supstore_df_new %>%
group_by(Ordered.Month) %>%
summarise(Orders = n_distinct(Order.ID),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))) %>%
mutate(Avg.sales.pct = round( (Average.sales/sum(Average.sales) * 100), 1),
Orders.pct = round( (Orders/sum(Orders) * 100), 1)) %>%
arrange((Ordered.Month))
supstore_df_orders_byMonths =
supstore_df_new %>%
group_by(Ordered.Month) %>%
summarise(Orders = n_distinct(Order.ID),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))) %>%
mutate(Avg.sales.pct = round( (Average.sales/sum(Average.sales) * 100), 1),
Orders.pct = round( (Orders/sum(Orders) * 100), 1)) %>%
arrange((Ordered.Month))
dplyr
install.packages(dplyr)
library(dplyr)
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(Product.Name) %>%
summarise(Orders = n_distinct(Order.ID),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))) %>%
mutate(Avg.sales.pct = round( (Average.sales/sum(Average.sales) * 100), 1),
Orders.pct = round( (Orders/sum(Orders) * 100), 1)) %>%
arrange((Orders.pct))
View(top5_articles)
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(Product.Name) %>%
mutate(Orders.pct = round( (Orders/sum(Orders) * 100), 1)) %>%
arrange((Orders.pct))
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(Product.Name) %>%
mutate(Orders = sum(Orders)) %>%
arrange((Orders))
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(Product.Name) %>%
mutate(Orders = n()) %>%
arrange((Orders))
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(Product.Name) %>%
mutate(Orders = n()) %>%
arrange((Orders))
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(Product.Name) %>%
mutate(Orders = n_distinct(Order.ID)) %>%
arrange((Orders))
View(top5_articles)
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(supstore_df_new$Product.Name) %>%
mutate(Orders = n_distinct(Order.ID)) %>%
arrange((Orders))
View(top5_articles)
#Top 5 Articles by Sold Items
top5_articles =
supstore_df_new %>%
group_by(Ordered.Year) %>%
mutate(Orders = n_distinct(Order.ID)) %>%
arrange((Orders))
View(top5_articles)
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
source('~/Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard/assoModel.R')
shiny::runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
colnames(supstore_df_new)
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp()
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp()
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp()
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
years = c("All years", unique(supstore_df_new$Ordered.Year))
years
# Extract years
region_list = c("US", unique(supstore_df_new$Region))
region_list
View(supstore_df_new)
unique(supstore_df_new$Region)
# Extract years
region_list = c("All region", unique(supstore_df_new$Region))
region_list
# Extract years
region_list = c("All Region", unique(supstore_df_new$Region))
region_list
#orders grouped by year
supstore_df_byYoY =
supstore_df_new %>%
group_by(Ordered.Year) %>%
summarise(Sub.Category, Orders = n(),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))
) %>%
mutate(Orders_pcnt = round( (Orders/sum(Orders) * 100), 1),
Orders_YoY_rise =  round((Orders - lag(Orders))/lag(Orders) * 100),
Sales_YoY_rise =  round((Average.sales - lag(Average.sales))/lag(Average.sales) * 100),
Profit_YoY_rise =  round((Average.profit - lag(Average.profit))/lag(Average.profit) * 100)
)
#orders grouped by year
supstore_df_byYoY =
supstore_df_new %>%
group_by(Sub.Category, Ordered.Year) %>%
summarise(Orders = n(),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))
) %>%
mutate(Orders_pcnt = round( (Orders/sum(Orders) * 100), 1),
Orders_YoY_rise =  round((Orders - lag(Orders))/lag(Orders) * 100),
Sales_YoY_rise =  round((Average.sales - lag(Average.sales))/lag(Average.sales) * 100),
Profit_YoY_rise =  round((Average.profit - lag(Average.profit))/lag(Average.profit) * 100)
)
#orders grouped by year
supstore_df_byYoY =
supstore_df_new %>%
group_by(Ordered.Year) %>%
summarise(Orders = n(),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))
) %>%
mutate(Orders_pcnt = round( (Orders/sum(Orders) * 100), 1),
Orders_YoY_rise =  round((Orders - lag(Orders))/lag(Orders) * 100),
Sales_YoY_rise =  round((Average.sales - lag(Average.sales))/lag(Average.sales) * 100),
Profit_YoY_rise =  round((Average.profit - lag(Average.profit))/lag(Average.profit) * 100)
)
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
#orders grouped by year
supstore_df_byYoY =
supstore_df_new %>%
group_by(Ordered.Year) %>%
summarise(Orders = n(),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))
) %>%
mutate(Orders_pcnt = round( (Orders/sum(Orders) * 100), 1),
Orders_YoY_rise =  round((Orders - lag(Orders))/lag(Orders) * 100),
Sales_YoY_rise =  round((Average.sales - lag(Average.sales))/lag(Average.sales) * 100),
Profit_YoY_rise =  round((Average.profit - lag(Average.profit))/lag(Average.profit) * 100)
)
#orders grouped by year
supstore_df_byYoY =
supstore_df_new %>%
group_by(Ordered.Year) %>%
summarise(Orders = n(),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))
) %>%
mutate(Orders_pcnt = round( (Orders/sum(Orders) * 100), 1),
Orders_YoY_rise =  round((Orders - lag(Orders))/lag(Orders) * 100),
Sales_YoY_rise =  round((Average.sales - lag(Average.sales))/lag(Average.sales) * 100),
Profit_YoY_rise =  round((Average.profit - lag(Average.profit))/lag(Average.profit) * 100)
)
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
library(dplyr)
#orders grouped by year
supstore_df_byYoY =
supstore_df_new %>%
group_by(Ordered.Year) %>%
summarise(Orders = n(),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))
) %>%
mutate(Orders_pcnt = round( (Orders/sum(Orders) * 100), 1),
Orders_YoY_rise =  round((Orders - lag(Orders))/lag(Orders) * 100),
Sales_YoY_rise =  round((Average.sales - lag(Average.sales))/lag(Average.sales) * 100),
Profit_YoY_rise =  round((Average.profit - lag(Average.profit))/lag(Average.profit) * 100)
)
#View the results in table format
show_table(supstore_df_byYoY, 10, isknit = TRUE)
#orders grouped by year
supstore_df_byYoY =
supstore_df_new %>%
group_by(Ordered.Year) %>%
summarise(Orders = n(),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))
) %>%
mutate(Orders_pcnt = round( (Orders/sum(Orders) * 100), 1),
Orders_YoY_rise =  round((Orders - lag(Orders))/lag(Orders) * 100),
Sales_YoY_rise =  round((Average.sales - lag(Average.sales))/lag(Average.sales) * 100),
Profit_YoY_rise =  round((Average.profit - lag(Average.profit))/lag(Average.profit) * 100)
)
#View the results in table format
show_table(supstore_df_byYoY, 10, isknit = FALSE)
#orders grouped by year
supstore_df_byYoY =
supstore_df_new %>%
group_by(Sub.Category, Ordered.Year) %>%
summarise(Orders = n(),
Average.profit = round(mean(Profit)),
Average.sales = round(mean(Sales))
) %>%
mutate(Orders_pcnt = round( (Orders/sum(Orders) * 100), 1),
Orders_YoY_rise =  round((Orders - lag(Orders))/lag(Orders) * 100),
Sales_YoY_rise =  round((Average.sales - lag(Average.sales))/lag(Average.sales) * 100),
Profit_YoY_rise =  round((Average.profit - lag(Average.profit))/lag(Average.profit) * 100)
)
#View the results in table format
show_table(supstore_df_byYoY, 10, isknit = FALSE)
length(supstore_df_byYoY)
dim(supstore_df_byYoY)
length(supstore_df_byYoY$Sub.Category)
row(supstore_df_byYoY)
row_number(supstore_df_byYoY)
rowSums(supstore_df_byYoY)
nrow(supstore_df_byYoY)
shiny::runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
shiny::runApp('Library/Mobile Documents/com~apple~CloudDocs/Worksspace/Pet-projects/r_repos/cust-segment-user-preference-analysis/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
runApp('Documents/Google Drive/Personal/CSDA1050-Capstone-Project-Repo/shinyUI/SuperstoreDashboard')
